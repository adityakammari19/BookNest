<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>
<div *ngIf="!isLoading">
  <div class="container mt-5">
    <h2>Order History</h2>
    <div *ngIf="orders!.length > 0; else noOrders">
      <div *ngFor="let order of orders" class="card mb-3">
        <div class="card-header">
          Order #{{ order.orderId }} on {{ order.orderDate | date }} - Paid
          {{ order.totalPrice | currency : "INR" }}
        </div>
        <div class="card-body">
          <h5 class="card-title">Shipping Address</h5>
          <p class="card-text">
            {{ order.address.houseNumber }}, {{ order.address.street }},
            {{ order.address.city }}, {{ order.address.state }},
            {{ order.address.zip }},
            {{ order.address.country }}
          </p>
          <h5 class="card-title">Ordered Books</h5>
          <ul class="list-group">
            <li
              *ngFor="let orderItem of order.orderItems"
              class="list-group-item"
            >
              <div class="row">
                <div class="col-md-2">
                  <img
                    [src]="
                      'data:image/jpeg;base64,' + orderItem.book?.coverImage
                    "
                    alt="{{ orderItem.book?.bookTitle }}"
                    width="50"
                  />
                </div>
                <div class="col-md-6">
                  <h6>{{ orderItem.book?.bookTitle }}</h6>
                  <p>{{ orderItem.book?.author }}</p>
                </div>
                <div class="col-md-2">
                  {{ orderItem.quantity }} x
                  {{ orderItem.book?.price | currency : "INR" }}
                </div>
                <div class="col-md-2">
                  {{
                    orderItem.quantity * orderItem.book?.price
                      | currency : "INR"
                  }}
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <ng-template #noOrders>
      <p>You have no orders.</p>
    </ng-template>
  </div>
</div>
